<!doctype html> 
<html lang="ar" dir="rtl">

<head>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù‚Ø§Ø¦Ø¯ Ø§Ù„ØµÙ</title>

  <style>

    :root{
      --accent:#0b74de;
      --bg:#f6f8fb;
      --border-accent: var(--accent);
    }

    *{margin:0;padding:0;box-sizing:border-box;font-family:"Tajawal",sans-serif}

    body{
      background:var(--bg);
      padding:20px;
      display:flex;
      flex-direction:column;
      gap:20px;
    }

    h1{
      color:var(--accent);
      text-align:center;
      font-size:28px;
      margin-bottom:10px;
    }

    .card{
      background:white;
      padding:20px;
      border-radius:15px;
      border:2px solid var(--border-accent);
      box-shadow:0 0 10px rgba(0,0,0,0.05);
    }

    label{
      font-size:18px;
      margin-bottom:10px;
      display:block;
      color:#333;
    }

    input[type="text"], textarea{
      width:100%;
      padding:12px;
      border-radius:10px;
      border:1px solid #ccc;
      outline:none;
      margin-bottom:15px;
      font-size:16px;
    }

    .btn{
      background:var(--accent);
      color:white;
      padding:12px 10px;
      width:100%;
      border:none;
      border-radius:12px;
      font-size:18px;
      cursor:pointer;
      transition:.3s;
    }

    .btn:hover{
      opacity:.85;
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ */
    .media-preview{
      display:flex;
      flex-wrap:wrap;
      gap:15px;
      margin-top:15px;
    }

    .media-preview img,
    .media-preview video{
      max-width:160px;
      border-radius:10px;
      border:2px solid var(--accent);
    }

  </style>

</head>

<body>

  <h1>ğŸ“Œ Ù†Ù…ÙˆØ°Ø¬ Ù‚Ø§Ø¦Ø¯ Ø§Ù„ØµÙ</h1>

  <div class="card">
    <label>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</label>
    <input type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§">

    <label>Ø³Ø¨Ø¨ Ø§Ù„ØªØ±Ø´ÙŠØ­:</label>
    <textarea rows="4" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø³Ø¨Ø¨ Ù‡Ù†Ø§"></textarea>

    <label>Ø¥Ø¶Ø§ÙØ© ØµÙˆØ± Ø£Ùˆ ÙÙŠØ¯ÙŠÙˆ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
    <input type="file" id="mediaInput" accept="image/*,video/*" multiple>

    <div class="media-preview" id="mediaPreview"></div>

    <button class="btn">Ø¥Ø±Ø³Ø§Ù„</button>
  </div>


  <script>

    /* ğŸ¨ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø¹Ù†Ø¯ ÙƒÙ„ Ø¯Ø®ÙˆÙ„ */
    function randomAccentColor() {
      const randomColor = "#" + Math.floor(Math.random()*16777215).toString(16);
      document.documentElement.style.setProperty('--accent', randomColor);
      document.documentElement.style.setProperty('--border-accent', randomColor);
    }
    randomAccentColor();


    /* ğŸ“¸ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø¹Ø¯ Ø§Ù„Ø±ÙØ¹ */
    const input = document.getElementById('mediaInput');
    const preview = document.getElementById('mediaPreview');

    input.addEventListener('change', function() {
      preview.innerHTML = ""; // Ù…Ø³Ø­ Ø§Ù„Ù‚Ø¯ÙŠÙ…

      [...this.files].forEach(file => {
        const reader = new FileReader();

        reader.onload = function(e) {
          let element;

          if(file.type.startsWith("image/")){
            element = document.createElement("img");
          } else if(file.type.startsWith("video/")){
            element = document.createElement("video");
            element.controls = true;
          }

          element.src = e.target.result;
          preview.appendChild(element);
        }

        reader.readAsDataURL(file);
      })
    });

  </script>

</body>
</html>

    </section>
  </div>

  <script>

    /* ğŸ¨ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ Ù…Ø§ ÙŠØ¯Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ */
    function randomAccentColor() {
      const randomColor = "#" + Math.floor(Math.random()*16777215).toString(16);
      document.documentElement.style.setProperty('--accent', randomColor);
      document.documentElement.style.setProperty('--border-accent', randomColor);
    }
    randomAccentColor();


    const SESSION_KEY='qaed_session', POSTS_KEY='qaed_posts', REACT_KEY='qaed_reacts', ADMIN_PASS_KEY='qaed_admin_pass';
    const DEFAULT_ADMIN_PASS = '12345678';

    const loginSelect=document.getElementById('loginSelect');
    const passwordInput=document.getElementById('passwordInput');
    const loginBtn=document.getElementById('loginBtn');
    const authButtons=document.getElementById('authButtons');
    const userInfo=document.getElementById('userInfo');
    const loginArea=document.getElementById('loginArea');
    const postEditor=document.getElementById('postEditor');
    const postTitle=document.getElementById('postTitle');
    const postBody=document.getElementById('postBody');
    const postImage=document.getElementById('postImage');
    const postsList=document.getElementById('postsList');
    const addPostBtn=document.getElementById('addPostBtn');
    const clearPostsBtn=document.getElementById('clearPostsBtn');
    const passChangeBox = document.getElementById('passChangeBox');
    const currentPass = document.getElementById('currentPass');
    const newPass = document.getElementById('newPass');
    const confirmPass = document.getElementById('confirmPass');
    const changePassBtn = document.getElementById('changePassBtn');
    const cancelChangeBtn = document.getElementById('cancelChangeBtn');

    function ensureAdminPass(){
      if(!localStorage.getItem(ADMIN_PASS_KEY)){
        localStorage.setItem(ADMIN_PASS_KEY, DEFAULT_ADMIN_PASS);
      }
    }
    function getStoredAdminPass(){ return localStorage.getItem(ADMIN_PASS_KEY) || DEFAULT_ADMIN_PASS; }
    function setStoredAdminPass(p){ localStorage.setItem(ADMIN_PASS_KEY, String(p)); }

    ensureAdminPass();

    function getSession(){try{return JSON.parse(localStorage.getItem(SESSION_KEY))||null}catch(e){return null}}
    function setSession(s){localStorage.setItem(SESSION_KEY,JSON.stringify(s));renderAuth();}
    function clearSession(){localStorage.removeItem(SESSION_KEY);renderAuth();}

    function loadPosts(){try{return JSON.parse(localStorage.getItem(POSTS_KEY))||[]}catch(e){return []}}
    function savePosts(p){localStorage.setItem(POSTS_KEY,JSON.stringify(p));}
    function loadReacts(){try{return JSON.parse(localStorage.getItem(REACT_KEY))||{};}catch(e){return {};} }
    function saveReacts(r){localStorage.setItem(REACT_KEY,JSON.stringify(r));}

    function escapeHtml(t){ return String(t).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

    function renderPosts(){
      const posts=loadPosts();postsList.innerHTML='';
      if(posts.length===0){postsList.innerHTML='<div style="color:#666">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø¨Ø¹Ø¯.</div>';return}
      posts.forEach((p,idx)=>{
        const el=document.createElement('div');el.className='post';
        el.innerHTML=`<div class="meta">Ø¨ÙˆØ§Ø³Ø·Ø©: <strong>${p.author}</strong> â€” ${new Date(p.time).toLocaleString('ar-EG')}</div>
        <h3>${escapeHtml(p.title)}</h3><div>${escapeHtml(p.body).replace(/\n/g,'<br>')}</div>`;
        if(p.image){
          const imgEl=document.createElement('img'); imgEl.src=p.image; el.appendChild(imgEl);
        }
        const emojiBar=document.createElement('div');emojiBar.className='emoji-bar';
        const emojis=['ğŸ‘','â¤ï¸','ğŸ˜‚','ğŸ‘','ğŸ¤”','ğŸ˜®'];
        emojis.forEach(e=>{
          const count=p.reactions&&p.reactions[e]?p.reactions[e]:0;
          const span=document.createElement('span');
          span.innerHTML=`<span class="emoji">${e}</span><span class="emoji-count">${count}</span>`;
          span.querySelector('.emoji').onclick=()=>reactToPost(idx,e);
          emojiBar.appendChild(span);
        });
        el.appendChild(emojiBar);

        const sess=getSession();
        if(sess&&sess.role==='admin'){
          const actions=document.createElement('div');actions.className='actions';
          const del=document.createElement('button');del.className='btn ghost';del.textContent='ğŸ—‘ Ø­Ø°Ù';
          del.onclick=()=>{if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø´ÙˆØ±ØŸ'))deletePost(idx);};
          const edit=document.createElement('button');edit.className='btn';edit.textContent='ØªØ¹Ø¯ÙŠÙ„';
          edit.onclick=()=>{editPost(idx);};
          actions.appendChild(edit);actions.appendChild(del);
          el.appendChild(actions);
        }
        postsList.prepend(el);
      });
    }

    function reactToPost(index,emoji){
      const posts=loadPosts(),reacts=loadReacts();
      const sess=getSession()||{role:'guest',name:'Ø¶ÙŠÙ'};
      const userId=sess.name+'_'+sess.role;
      if(!reacts[index])reacts[index]={};
      const prev=reacts[index][userId];
      if(prev===emoji){
        if(posts[index].reactions && posts[index].reactions[emoji]>0)posts[index].reactions[emoji]--;
        delete reacts[index][userId];
      }else{
        if(prev && posts[index].reactions && posts[index].reactions[prev]>0)posts[index].reactions[prev]--;
        if(!posts[index].reactions)posts[index].reactions={};
        if(!posts[index].reactions[emoji])posts[index].reactions[emoji]=0;
        posts[index].reactions[emoji]++;
        reacts[index][userId]=emoji;
      }
      savePosts(posts);saveReacts(reacts);renderPosts();
    }

    function addPost(title, body, author, image){
      const posts = loadPosts();
      posts.push({title, body, author, time: Date.now(), reactions:{}, image});
      savePosts(posts);
      renderPosts();
    }

    function deletePost(i){const posts=loadPosts();posts.splice(i,1);savePosts(posts);renderPosts();}
    function editPost(i){
      const posts=loadPosts();const p=posts[i];
      const newTitle=prompt('Ø¹Ø¯Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†Ø´ÙˆØ±:',p.title); if(newTitle===null) return;
      const newBody=prompt('Ø¹Ø¯Ù„ Ù†Øµ Ø§Ù„Ù…Ù†Ø´ÙˆØ±:',p.body); if(newBody===null) return;
      posts[i].title=newTitle; posts[i].body=newBody; savePosts(posts); renderPosts();
    }

    clearPostsBtn.onclick=()=>{ if(confirm('Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§ØªØŸ')){ savePosts([]); renderPosts(); } };

    loginBtn.onclick=()=>{
      const choice=loginSelect.value;
      if(choice==='guest'){ setSession({role:'guest',name:'Ø¶ÙŠÙ'}); return; }
      const pass=passwordInput.value||'';
      if(pass===getStoredAdminPass()){ setSession({role:'admin',name:'ADMIN'}); passwordInput.value=''; }
      else{ alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©'); }
    }

    function logout(){ clearSession(); }

    function renderAuth(){
      const sess=getSession(); authButtons.innerHTML='';
      if(!sess){
        userInfo.textContent=''; loginArea.style.display='block'; postEditor.style.display='none'; passChangeBox.style.display='none';
      } else {
        userInfo.textContent=`${sess.name} â€” ${sess.role}`;
        loginArea.style.display='none';
        const out=document.createElement('button'); out.className='btn ghost'; out.textContent='ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬'; out.onclick=logout;
        authButtons.appendChild(out);
        if(sess.role==='admin'){ postEditor.style.display='block'; passChangeBox.style.display='block'; }
        else { postEditor.style.display='none'; passChangeBox.style.display='none'; }
      }
      renderPosts();
    }

    addPostBtn.onclick=()=>{
      const sess = getSession();
      if(!sess || sess.role !== 'admin'){ alert('ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† ADMIN Ù„Ù†Ø´Ø± Ù…Ù†Ø´ÙˆØ±.'); return; }
      const t = postTitle.value.trim(), b = postBody.value.trim();

      if(!t && !b && (!postImage.files || postImage.files.length===0)){ alert('Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø£Ùˆ Ù†Øµ Ø£Ùˆ ØµÙˆØ±Ø© Ù„Ù„Ù…Ù†Ø´ÙˆØ±.'); return; }

      if(postImage.files && postImage.files[0]){
        const reader = new FileReader();
        reader.onload = function(e){
          addPost(t,b,sess.name,e.target.result);
          postTitle.value=''; postBody.value=''; postImage.value='';
        };
        reader.readAsDataURL(postImage.files[0]);
      } else {
        addPost(t,b,sess.name,'');
        postTitle.value=''; postBody.value='';
      }
    };

    changePassBtn.onclick=()=>{
      const cur = currentPass.value || '';
      const n = newPass.value || '';
      const c = confirmPass.value || '';
      const stored = getStoredAdminPass();

      if(cur === ''){ alert('Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©.'); return; }
      if(cur !== stored){ alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©.'); return; }
      if(n.length < 4){ alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù‚ØµÙŠØ±Ø© â€” Ø§Ø¬Ø¹Ù„Ù‡Ø§ 4 Ø£Ø­Ø±Ù Ø£Ùˆ Ø£ÙƒØ«Ø±.'); return; }
      if(n !== c){ alert('ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø§ ÙŠØ·Ø§Ø¨Ù‚.'); return; }

      setStoredAdminPass(n);
      currentPass.value=''; newPass.value=''; confirmPass.value='';
      alert('ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù† Ø¨Ù†Ø¬Ø§Ø­.');
    };

    cancelChangeBtn.onclick=()=>{ 
      currentPass.value=''; newPass.value=''; confirmPass.value=''; 
    };

    (function init(){ ensureAdminPass(); renderAuth(); renderPosts(); })();

  </script>

</body>

</html>
    

